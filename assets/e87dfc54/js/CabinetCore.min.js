"use strict";var CabinetCase=function(n){n=$.extend(!0,{items:[],itemStatuses:[],openKeyUrl:"",sendAssetUrl:"",tryFindPrizeUrl:""},n);var e={openKey:"#open-key",keyBtn:"#get-key",openNewCase:"#open-new-case",steamBtn:".steam-button"};n=$.extend(!0,{swalAsset:{options:{title:LandingCore.t("Вы уверены?"),html:LandingCore.t('Предмет будет отправлен на вывод в ваш Steam-аккаунт. <p style="color: #ff1e00"><br>{cancelOfferInfo}</p>',{cancelOfferInfo:LandingCore.t("Обратите внимание. Если вы не примете предмет в стиме в течение {hours}, вывод будет автоматически отменен.",{hours:n.hoursBeforeCancelOffer+" "+LandingCore.plural(n.hoursBeforeCancelOffer,[LandingCore.t("часа"),LandingCore.t("часов"),LandingCore.t("часов")])})}),type:"question",confirmButtonText:LandingCore.t("Да, я уверен!"),cancelButtonText:LandingCore.t("Нет, я передумал...")},inactiveUser:{title:"",html:'<span class="account-activation-text">'+LandingCore.t("Необходима активация аккаунта")+'</span><div class="alert alert-danger text-justify">'+LandingCore.t("Для доступа к полному функционалу сайта пополните баланс на сумму <strong>от {amountRub}</strong>. Пополнив свой баланс, вы сможете выводить все предметы, в том числе и полученные в наших бесплатных розыгрышах.",{amountRub:n.rubToActivate})+"</div>",type:"warning"},successParams:[LandingCore.t("Успех!"),LandingCore.t("Предмет был отправлен на ваш Steam-аккаунт, подтвердите прием предмета в Steam."),"success"],cancelParams:[LandingCore.t("Действие отменено"),LandingCore.t("Вы сможете вывести свой предмет в любое удобное для вас время."),"error"],errorParams:[LandingCore.t("Ой!"),LandingCore.t("К сожалениею произошла ошибка при попытке вывести предмет. Попробуйте, пожалуйста, позже."),"error"]},swalKey:{options:{title:LandingCore.t("Вы уверены?"),text:LandingCore.t("После получения ключа данную игру будет нельзя продать"),type:"question",confirmButtonText:LandingCore.t("Да, я уверен!"),cancelButtonText:LandingCore.t("Нет, я передумал...")},successParams:[LandingCore.t("Получение ключа"),LandingCore.t("Ваш ключ: <b>%s</b> <br>"),"success"],cancelParams:[LandingCore.t("Действие отменено"),LandingCore.t("Вы сможете получить свой ключ в любое удобное для вас время."),"error"],errorParams:[LandingCore.t("Ой!"),LandingCore.t("К сожалениею произошла ошибка при попытке открыть ключ. Попробуйте, пожалуйста, позже."),"error"]},openCase:{option:{title:LandingCore.t("Вы уверены?"),text:LandingCore.t("Что хотите открыть кейс?"),type:"question",confirmButtonText:LandingCore.t("Да, я уверен!"),cancelButtonText:LandingCore.t("Нет, я передумал..."),showCancelButton:!0,allowOutsideClick:!1,showLoaderOnConfirm:!0},cancelParams:[LandingCore.t("Действие отменено"),LandingCore.t("Вы сможете открыть кейс в любое удобное для вас время."),"error"],errorParams:[LandingCore.t("Ой!"),LandingCore.t("К сожалениею произошла ошибка при попытке открыть кейс. Попробуйте, пожалуйста, позже."),"error"]},openKey:{option:[LandingCore.t("Получение ключа"),LandingCore.t("Ваш ключ: <b>%s</b> <br>"),"success"]}},n);var t={tryFindPrize:!1};$("body").on("click",e.openKey,function(e){var t=$(this).attr("data-key"),a=Object.assign([],n.openKey.option);a[1]=a[1].replace(/%s/,t),swal.apply(null,a)}).on("click",e.openNewCase,function(e){e.preventDefault();var a=$(this).attr("href"),r=$(this).attr("data-status"),o=$(this).attr("data-id");return r===n.itemStatuses.caseError?!t.tryFindPrize&&(t.tryFindPrize=!0,$.ajax({url:n.tryFindPrizeUrl,data:{_csrf:LandingCore.getCsrfToken(),itemId:o},format:"json",method:"POST",success:function(e){if("error"===e.status){var r=n.openCase.errorParams;r[1]=e.msg,swal.apply(null,r)}else swal(n.openCase.option).then(function(){location.href=a},function(e){"cancel"===e&&swal.apply(null,n.openCase.cancelParams)});t.tryFindPrize=!1},error:function(){t.tryFindPrize=!1}}),!1):void swal(n.openCase.option).then(function(){location.href=a},function(e){"cancel"===e&&swal.apply(null,n.openCase.cancelParams)})}),OpenKey(n,e),SendAsset(n,e)},SendAsset=function(n,e){var t={showCancelButton:!0,allowOutsideClick:!1,showLoaderOnConfirm:!0},a=n.swalAsset.options;t=$.extend(!0,t,a),$("body").on("click",e.steamBtn,function(e){e.preventDefault();var a=$(this).attr("data-id");t.preConfirm=function(){return new Promise(function(e,t){$.ajax({url:n.sendAssetUrl,data:{_csrf:LandingCore.getCsrfToken(),itemId:a},format:"json",method:"POST",success:function(n){return"error"===n.status?(t(n.msg),!1):void e()},error:function(){swal.apply(null,n.swalAsset.errorParams)}})})},swal(t).then(function(e){swal.apply(null,n.swalAsset.successParams)},function(e){"cancel"===e&&swal.apply(null,n.swalAsset.cancelParams)})})},OpenKey=function(n,e){var t={showCancelButton:!0,allowOutsideClick:!1,showLoaderOnConfirm:!0},a=n.swalKey.successParams[1];t=$.extend(!0,t,n.swalKey.options),$("body").on("click",e.keyBtn,function(e){e.preventDefault();var r=$(this).attr("data-id");t.preConfirm=function(){return new Promise(function(t,a){$.ajax({url:n.openKeyUrl,data:{_csrf:LandingCore.getCsrfToken(),itemId:r},format:"json",method:"POST",success:function(n){return"error"===n.status?(a(n.msg),!1):void t(n,e.target)},error:function(){swal.apply(null,n.swalKey.errorParams)}})})},swal(t).then(function(t){var r=a;n.swalKey.successParams[1]=r.replace(/%s/,t.msg),swal.apply(null,n.swalKey.successParams).then(function(){var n=$(e.target);n.attr("id","open-key"),n.attr("data-key",t.msg),n.parent().find("#resale-btn").hide()})},function(e){"cancel"===e&&swal.apply(null,n.swalKey.cancelParams)})})},LotteryPage=function(n){var e=$.extend(!0,{endOfLottery:0,showModalHowIt:!1},n),t="MinuteCounter";e.endOfLottery>=3600&&(t="TwentyFourHourClock");var a=$(".clock").FlipClock({clockFace:t,autoStart:!0,countdown:!0,language:"ru-ru"});a.setTime(e.endOfLottery),a.setCountdown(!0),a.start(),e.showModalHowIt&&$("#how-it").modal()},ResaleItem=function(n){var e=$.extend(!0,{resaleUrl:null,objectNetCost:0},n),t={resaleBtn:"#resale-btn",inventoryItem:".inventory-item",activeInventoryItem:".inventory-item.active"},a={options:{title:LandingCore.t("Вы уверены?"),html:"",type:"question",confirmButtonText:LandingCore.t("Да, я уверен!"),cancelButtonText:LandingCore.t("Нет, я передумал..."),showCancelButton:!0,allowOutsideClick:!1,showLoaderOnConfirm:!0},cancelParams:[LandingCore.t("Действие отменено"),LandingCore.t("Вы сможете продать свой предмет в любое удобное для вас время."),"error"]};$("body").on("click",t.resaleBtn,function(n){n.preventDefault();var t=$(this).attr("data-id"),r=$(this).data("net-cost")||e.objectNetCost,o=e.resaleUrl,s=parseFloat(r),i=LandingCore.currencyNames.getPlurals(LandingConfig.currencyId),l=s+" "+LandingCore.plural(s,i);a.options.html=LandingCore.t("Вы уверены, что хотите продать этот предмет за <strong>{amountMoney}</strong>?",{amountMoney:l}),a.options.preConfirm=function(){return new Promise(function(n,e){$.post(o,{_csrf:LandingCore.getCsrfToken(),itemId:t},function(e){n(e)})},"json")},swal(a.options).then(function(n){if("error"===n.status){var e=[LandingCore.t("Упс..."),n.msg,"error"];swal.apply(null,e)}else"ok"===n.status&&"undefined"!=typeof n.returnUrl&&swal(LandingCore.t("Предмет продан"),n.msg,"success").then(function(){window.location.href=n.returnUrl})},function(n){"cancel"===n&&swal.apply(null,a.cancelParams)})})};